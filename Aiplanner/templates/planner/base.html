{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{% block title %}AI Habit Tracker{% endblock %}</title>

    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <style>
      .logo-area {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 15px 20px;
      }

      .app-logo {
        width: 36px;
        height: 36px;
        object-fit: contain;
      }

      .logo-text {
        font-size: 20px;
        font-weight: 700;
        background: linear-gradient(90deg, #7b5bff, #4fc3f7);
        -webkit-background-clip: text;
        color: transparent;
      }
    </style>

    <script
      src="https://kit.fontawesome.com/a2f4b1b7ac.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="logo-area">
          <img src="{% static 'images/logo.png' %}" class="app-logo" />
          <span class="logo-text">HabitHack</span>
        </div>

        <nav class="sidebar-nav full">
          <a
            href="{% url 'home' %}"
            class="nav-item {% if request.path == '/' %}active{% endif %}"
          >
            <i class="fas fa-home"></i>
            <span>Home</span>
          </a>

          <a
            href="{% url 'habits' %}"
            class="nav-item {% if '/habits' in request.path %}active{% endif %}"
          >
            <i class="fas fa-check-circle"></i>
            <span>Habits</span>
          </a>

          <a
            href="{% url 'stats' %}"
            class="nav-item {% if '/stats' in request.path %}active{% endif %}"
          >
            <i class="fas fa-chart-line"></i>
            <span>Statistics</span>
          </a>

          <a
            href="{% url 'streaks' %}"
            class="nav-item {% if '/streaks' in request.path %}active{% endif %}"
          >
            <i class="fas fa-fire"></i>
            <span>Streaks</span>
          </a>

          <a
            href="{% url 'ai_suggestions' %}"
            class="nav-item {% if '/ai_suggestions' in request.path %}active{% endif %}"
          >
            <i class="fas fa-robot"></i>
            <span>AI Suggestions</span>
          </a>

          <a
            href="{% url 'ai_chat' %}"
            class="nav-item {% if '/ai_chat' in request.path %}active{% endif %}"
          >
            <i class="fas fa-comments"></i>
            <span>AI Chat</span>
          </a>
        </nav>
      </aside>

      <!-- Main content -->
      <main class="main">
        <!-- TOPBAR -->
        <header class="topbar">
          <div class="breadcrumbs"></div>

          <div class="topbar-right">
            <a href="{% url 'about' %}" class="top-link">About</a>
            <a href="{% url 'settings' %}" class="top-link">Settings</a>

            {% if user.is_authenticated %}

            <a
              href="{% url 'profile' %}"
              class="nav-item active"
              title="Profile"
            >
              <div class="user-avatar" style="width: 32px; height: 32px">
                {{ user.first_name|default:user.username|first|upper }}
              </div>
            </a>

            {% else %}

            <a href="{% url 'login' %}" class="top-link">Login</a>
            <a href="{% url 'register' %}" class="top-link">Register</a>

            <a href="{% url 'login' %}" class="nav-item">
              <i class="fas fa-sign-in-alt"></i>
            </a>

            {% endif %}
          </div>
        </header>

        <section class="page">{% block content %}{% endblock %}</section>
      </main>
    </div>

    <!-- ONLY TOAST SYSTEM -->
    {% if messages %}
    <div id="toast-box">
      {% for message in messages %}
      <div class="toast-msg">{{ message }}</div>
      {% endfor %}
    </div>

    <script>
      setTimeout(() => {
        const toastBox = document.getElementById("toast-box");
        if (toastBox) {
          toastBox.style.opacity = "0";
          setTimeout(() => toastBox.remove(), 600);
        }
      }, 2000);
    </script>
    {% endif %}

    <script src="{% static 'js/main.js' %}"></script>
  </body>
</html>
